<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Affichage Tokens - Correction</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .tabs { display: flex; gap: 8px; margin-bottom: 20px; border-bottom: 1px solid #ddd; }
        .tab { padding: 8px 16px; border: none; background: #f0f0f0; cursor: pointer; border-radius: 4px 4px 0 0; }
        .tab.active { background: #007acc; color: white; }
        .token-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 16px; }
        .token-item { display: flex; align-items: center; gap: 12px; padding: 12px; background: #f9f9f9; border-radius: 8px; border: 1px solid #ddd; }
        .token-preview { flex-shrink: 0; }
        .token-info { flex: 1; }
        .token-name { font-family: monospace; font-size: 12px; font-weight: 600; margin-bottom: 4px; }
        .token-value { font-family: monospace; font-size: 11px; color: #666; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Affichage des Tokens - Correction Appliqu√©e</h1>

        <div class="tabs" id="tokenTabs">
            <button class="tab active" data-category="brand">Brand</button>
            <button class="tab" data-category="system">System</button>
            <button class="tab" data-category="gray">Gray</button>
            <button class="tab" data-category="spacing">Spacing</button>
            <button class="tab" data-category="radius">Radius</button>
            <button class="tab" data-category="typography">Typography</button>
            <button class="tab" data-category="border">Border</button>
        </div>

        <div id="tokenPreview">
            <div style="text-align: center; padding: 40px; color: #666;">
                Simulation : Tokens g√©n√©r√©s mais pas encore affich√©s
            </div>
        </div>

        <br><br>
        <button id="simulateTokensGenerated">Simuler la r√©ception des tokens</button>
        <button id="simulateStep3">Simuler le passage √† l'√©tape 3</button>

        <div id="logs"></div>
    </div>

    <script>
        // Simuler les variables globales
        var currentTokens = null;
        var activeCategory = "brand";
        var currentNaming = "mui";

        const logsDiv = document.getElementById('logs');

        function log(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = type;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logsDiv.appendChild(entry);
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        // Simuler les tokens g√©n√©r√©s (comme dans vos logs)
        const generatedTokens = {
            brand: {
                subtle: "#FBFAF4",
                light: "#F3F3E2",
                base: "#6366F1",
                hover: "#FFFFFF",
                dark: "#FFFFFF"
            },
            system: {
                "success-light": "#FDE7EF",
                "success-main": "#10B981",
                "success-dark": "#FFFFFF",
                "warning-light": "#E7EFFE",
                "warning-main": "#F59E0B",
                "warning-dark": "#FFFFFF",
                "error-light": "#FDE2E1",
                "error-main": "#EF4444",
                "error-dark": "#FFFFFF",
                "info-light": "#DBEAFE",
                "info-main": "#3B82F6",
                "info-dark": "#FFFFFF"
            },
            gray: {
                "50": "#F9FAFB",
                "100": "#F3F4F6",
                "200": "#E5E7EB",
                "300": "#D1D5DB",
                "400": "#9CA3AF",
                "500": "#6B7280",
                "600": "#4B5563",
                "700": "#374151",
                "800": "#1F2937",
                "900": "#111827",
                "950": "#030712",
                white: "#FFFFFF"
            },
            spacing: {
                "1": "4px",
                "2": "8px",
                "3": "12px",
                "4": "16px",
                "5": "20px"
            },
            radius: {
                "sm": "2px",
                "default": "4px",
                "md": "6px",
                "lg": "8px",
                "xl": "12px"
            },
            typography: {
                "text-xs": "0.75rem",
                "text-sm": "0.875rem",
                "text-base": "1rem",
                "text-lg": "1.125rem",
                "text-xl": "1.25rem"
            },
            border: {
                "1": "1px",
                "2": "2px",
                "4": "4px"
            }
        };

        // Fonction updatePreview (simul√©e)
        function updatePreview() {
            log('üìä updatePreview() appel√©e avec activeCategory: ' + activeCategory);

            if (!currentTokens) {
                log('‚ùå currentTokens est null', 'error');
                return;
            }

            var categoryData = currentTokens[activeCategory];
            if (!categoryData) {
                log('‚ùå Pas de donn√©es pour la cat√©gorie: ' + activeCategory, 'error');
                return;
            }

            log('‚úÖ Affichage de ' + Object.keys(categoryData).length + ' tokens pour ' + activeCategory, 'success');

            var tokenPreview = document.getElementById("tokenPreview");
            var isColor = (activeCategory === "brand" || activeCategory === "system" || activeCategory === "gray");

            var html = '<div class="token-grid">';

            Object.keys(categoryData).forEach(function(key) {
                var value = categoryData[key];
                var previewStyle = '';

                if (typeof value === 'string' && value.startsWith('#')) {
                    previewStyle = 'background-color: ' + value + '; width: 24px; height: 24px; border-radius: 4px; border: 1px solid #ddd;';
                } else if (typeof value === 'string' && (value.includes('px') || value.includes('rem'))) {
                    previewStyle = 'width: 40px; height: 8px; background: #007acc; border-radius: 2px;';
                }

                html += '<div class="token-item">';
                html += '<div class="token-preview" style="' + previewStyle + '"></div>';
                html += '<div class="token-info">';
                html += '<div class="token-name">' + key + '</div>';
                html += '<div class="token-value">' + value + '</div>';
                html += '</div>';
                html += '</div>';
            });

            html += '</div>';
            tokenPreview.innerHTML = html;
        }

        // Gestionnaire d'onglets
        document.getElementById('tokenTabs').addEventListener("click", function (e) {
            if (e.target.classList.contains("tab")) {
                var tabs = this.querySelectorAll(".tab");
                tabs.forEach(function (tab) { tab.classList.remove("active"); });
                e.target.classList.add("active");
                activeCategory = e.target.getAttribute("data-category");
                updatePreview();
            }
        });

        // Simuler la r√©ception des tokens
        document.getElementById('simulateTokensGenerated').addEventListener('click', function() {
            log('üéâ Simulation: tokens-generated message received');

            // Simuler ce qui se passe dans ui.html
            currentTokens = generatedTokens;

            log('‚úÖ currentTokens mis √† jour avec ' + Object.keys(currentTokens).length + ' cat√©gories', 'success');
            log('üì¶ Tokens disponibles: ' + Object.keys(currentTokens).join(', '));
        });

        // Simuler le passage √† l'√©tape 3
        document.getElementById('simulateStep3').addEventListener('click', function() {
            log('üîÑ Simulation: Passage √† l\'√©tape 3 (r√©sultats)');

            if (currentTokens) {
                // Activer l'onglet brand par d√©faut
                var brandTab = document.querySelector('.tab[data-category="brand"]');
                if (brandTab) {
                    document.querySelectorAll('.tab').forEach(function(tab) { tab.classList.remove('active'); });
                    brandTab.classList.add('active');
                    activeCategory = 'brand';
                    log('‚úÖ Onglet "brand" activ√© par d√©faut');
                }

                updatePreview();
                log('‚úÖ updatePreview() appel√©e', 'success');
            } else {
                log('‚ùå currentTokens est null - g√©n√©rez d\'abord les tokens', 'error');
            }
        });

        log('üéØ Test pr√™t. Cliquez sur "Simuler la r√©ception des tokens" puis "Simuler le passage √† l\'√©tape 3"');
    </script>
</body>
</html>