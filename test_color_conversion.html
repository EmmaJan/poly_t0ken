<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Conversion Couleurs</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 20px 0; padding: 10px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        .result { font-family: monospace; margin: 5px 0; }
    </style>
</head>
<body>
    <h1>Test des Fonctions de Conversion de Couleur</h1>

    <div id="results"></div>

    <script src="code.js"></script>

    <script>
        const results = document.getElementById('results');

        function test(name, testFn) {
            const div = document.createElement('div');
            div.className = 'test';
            div.innerHTML = `<h3>${name}</h3>`;

            try {
                const result = testFn();
                div.innerHTML += `<div class="success">✅ Test réussi</div>`;
                div.innerHTML += `<div class="result">${result}</div>`;
            } catch (error) {
                div.innerHTML += `<div class="error">❌ Erreur: ${error.message}</div>`;
                console.error(error);
            }

            results.appendChild(div);
        }

        // Tests des fonctions de conversion
        test('hexToRgb("#FF0000")', () => {
            const rgb = hexToRgb("#FF0000");
            const expected = { r: 255, g: 0, b: 0 };
            if (rgb.r !== expected.r || rgb.g !== expected.g || rgb.b !== expected.b) {
                throw new Error(`Expected ${JSON.stringify(expected)}, got ${JSON.stringify(rgb)}`);
            }
            return `RGB: ${JSON.stringify(rgb)}`;
        });

        test('hexToRgb("#007ACC")', () => {
            const rgb = hexToRgb("#007ACC");
            const expected = { r: 0, g: 122, b: 204 };
            if (rgb.r !== expected.r || rgb.g !== expected.g || rgb.b !== expected.b) {
                throw new Error(`Expected ${JSON.stringify(expected)}, got ${JSON.stringify(rgb)}`);
            }
            return `RGB: ${JSON.stringify(rgb)}`;
        });

        test('hexToHsl("#FF0000")', () => {
            const hsl = hexToHsl("#FF0000");
            const expected = { h: 0, s: 100, l: 50 };
            // Tolérance pour les calculs flottants
            if (Math.abs(hsl.h - expected.h) > 1 ||
                Math.abs(hsl.s - expected.s) > 1 ||
                Math.abs(hsl.l - expected.l) > 1) {
                throw new Error(`Expected ${JSON.stringify(expected)}, got ${JSON.stringify(hsl)}`);
            }
            return `HSL: ${JSON.stringify(hsl)}`;
        });

        test('hslToHex(0, 100, 50)', () => {
            const hex = hslToHex(0, 100, 50);
            const expected = "#FF0000";
            if (hex.toUpperCase() !== expected) {
                throw new Error(`Expected ${expected}, got ${hex}`);
            }
            return `Hex: ${hex}`;
        });

        test('Conversion round-trip #007ACC', () => {
            const original = "#007ACC";
            const hsl = hexToHsl(original);
            const backToHex = hslToHex(hsl.h, hsl.s, hsl.l);

            // Vérifier que c'est proche de l'original
            const rgb1 = hexToRgb(original);
            const rgb2 = hexToRgb(backToHex);

            const diff = Math.abs(rgb1.r - rgb2.r) + Math.abs(rgb1.g - rgb2.g) + Math.abs(rgb1.b - rgb2.b);
            if (diff > 5) { // Tolérance de 5 unités RGB
                throw new Error(`Round-trip failed: ${original} -> ${backToHex} (diff: ${diff})`);
            }

            return `Original: ${original}, Round-trip: ${backToHex}`;
        });

        test('generateBrandColors("#007ACC", "custom")', () => {
            const tokens = generateBrandColors("#007ACC", "custom");
            if (!tokens || typeof tokens !== 'object') {
                throw new Error('No tokens returned');
            }
            if (!tokens.subtle || !tokens.light || !tokens.base || !tokens.hover || !tokens.dark) {
                throw new Error('Missing token properties');
            }
            return `Tokens: ${Object.keys(tokens).length} properties - ${JSON.stringify(tokens)}`;
        });
    </script>
</body>
</html>