# üé® EXEMPLE - Export CSS Conforme aux Standards

## Structure Attendue

Voici un exemple complet de l'export CSS que le plugin devrait g√©n√©rer, conforme aux standards des librairies modernes.

---

## Export CSS Complet

```css
/**
 * Design Tokens - CSS Variables
 * Generated by PolyToken
 * Library: Tailwind
 * Generated: 2025-01-22
 */

/* ============================================
   PRIMITIVES - D√©finitions de base
   ============================================ */

:root {
  /* BRAND */
  --brand-50: #F5F2F0;
  --brand-100: #E4D6CA;
  --brand-200: #DABA9C;
  --brand-300: #D7A473;
  --brand-400: #D79353;
  --brand-500: #D58234;
  --brand-600: #BE6E23;
  --brand-700: #A05B1A;
  --brand-800: #774211;
  --brand-900: #4D2A09;
  --brand-950: #3C2006;
  --brand-error: #EE4544;
  --brand-info: #3E82F2;
  --brand-success: #14B87F;
  --brand-warning: #F49D0C;

  /* GRAY */
  --gray-50: #F3F2F2;
  --gray-100: #DDDBDA;
  --gray-200: #C7C4C1;
  --gray-300: #B1ADA9;
  --gray-400: #9C9691;
  --gray-500: #867F79;
  --gray-600: #6E6863;
  --gray-700: #56514E;
  --gray-800: #3E3B38;
  --gray-900: #252422;
  --gray-950: #0D0D0C;
  --gray-black: #000000;
  --gray-white: #FFFFFF;

  /* RADIUS */
  --radius-scale-none: 0;
  --radius-scale-sm: 2px;
  --radius-scale-2: 2px;
  --radius-scale-base: 4px;
  --radius-scale-4: 4px;
  --radius-scale-md: 6px;
  --radius-scale-6: 6px;
  --radius-scale-lg: 8px;
  --radius-scale-8: 8px;
  --radius-scale-xl: 12px;
  --radius-scale-2xl: 16px;
  --radius-scale-3xl: 24px;
  --radius-scale-full: 9999px;

  /* SPACING */
  --spacing-1: 1px;
  --spacing-2: 2px;
  --spacing-4: 4px;
  --spacing-scale-4: 4px;
  --spacing-scale-8: 8px;
  --spacing-scale-12: 12px;
  --spacing-scale-16: 16px;
  --spacing-scale-20: 20px;
  --spacing-scale-24: 24px;
  --spacing-scale-32: 32px;
  --spacing-scale-40: 40px;
  --spacing-scale-48: 48px;
  --spacing-scale-64: 64px;
  --spacing-scale-80: 80px;
  --spacing-scale-96: 96px;
  --spacing-scale-128: 128px;
  --spacing-scale-160: 160px;
  --spacing-scale-192: 192px;
  --spacing-scale-224: 224px;
  --spacing-scale-256: 256px;

  /* TYPOGRAPHY */
  --typography-12: 0.75rem;
  --typography-14: 0.875rem;
  --typography-16: 1rem;
  --typography-18: 1.125rem;
  --typography-text-xs: 0.75rem;
  --typography-text-sm: 0.875rem;
  --typography-text-base: 1rem;
  --typography-text-lg: 1.125rem;
  --typography-text-xl: 1.25rem;
  --typography-weight-light: 300;
  --typography-weight-normal: 400;
  --typography-weight-400: 400;
  --typography-weight-medium: 500;
  --typography-weight-semibold: 600;
  --typography-weight-600: 600;
  --typography-weight-bold: 700;
  --typography-weight-700: 700;
}

/* ============================================
   SEMANTIC LAYER - Light Theme
   ============================================ */

html[data-theme='light'] {
  /* Background */
  --color-bg-canvas: var(--gray-50);
  --color-bg-surface: var(--gray-white);
  --color-bg-elevated: var(--gray-100);
  --color-bg-subtle: var(--gray-100);
  --color-bg-muted: var(--gray-200);
  --color-bg-accent: var(--brand-500);
  --color-bg-inverse: var(--gray-900);

  /* Text */
  --color-text-primary: var(--gray-900);
  --color-text-secondary: var(--gray-700);
  --color-text-muted: var(--gray-500);
  --color-text-accent: var(--brand-600);
  --color-text-link: var(--brand-500);
  --color-text-disabled: var(--gray-400);
  --color-text-inverse: var(--gray-white);
  --color-text-on-inverse: var(--gray-white);

  /* Border */
  --color-border-default: var(--gray-200);
  --color-border-muted: var(--gray-100);
  --color-border-accent: var(--brand-200);
  --color-border-focus: var(--brand-500);

  /* Action Primary */
  --color-action-primary: var(--brand-500);
  --color-action-primary-hover: var(--brand-600);
  --color-action-primary-active: var(--brand-700);
  --color-action-primary-disabled: var(--gray-300);
  --color-action-primary-text: var(--gray-white);

  /* Action Secondary */
  --color-action-secondary: var(--gray-100);
  --color-action-secondary-hover: var(--gray-200);
  --color-action-secondary-active: var(--gray-300);
  --color-action-secondary-disabled: var(--gray-100);
  --color-action-secondary-text: var(--gray-900);

  /* Status */
  --color-status-success: var(--brand-success);
  --color-status-success-text: var(--gray-white);
  --color-status-warning: var(--brand-warning);
  --color-status-warning-text: var(--gray-900);
  --color-status-error: var(--brand-error);
  --color-status-error-text: var(--gray-white);
  --color-status-info: var(--brand-info);
  --color-status-info-text: var(--gray-white);

  /* On-colors (Contrast Text) */
  --color-on-primary: var(--gray-white);
  --color-on-secondary: var(--gray-900);
  --color-on-success: var(--gray-white);
  --color-on-warning: var(--gray-900);
  --color-on-error: var(--gray-white);
  --color-on-info: var(--gray-white);
  --color-on-inverse: var(--gray-white);

  /* Spacing */
  --space-xs: var(--spacing-4);
  --space-sm: var(--spacing-scale-8);
  --space-md: var(--spacing-scale-16);
  --space-lg: var(--spacing-scale-24);
  --space-xl: var(--spacing-scale-32);

  /* Radius */
  --radius-xs: var(--radius-scale-none);
  --radius-sm: var(--spacing-2);
  --radius-md: var(--radius-scale-md);
  --radius-lg: var(--spacing-scale-8);
  --radius-xl: var(--spacing-scale-12);

  /* Typography */
  --font-size-xs: var(--spacing-scale-12);
  --font-size-sm: var(--typography-14);
  --font-size-base: var(--spacing-scale-16);
  --font-size-lg: var(--typography-18);
  --font-size-xl: var(--spacing-scale-16);
  --font-weight-light: var(--typography-weight-normal);
  --font-weight-normal: var(--typography-weight-normal);
  --font-weight-medium: var(--typography-weight-normal);
  --font-weight-semibold: var(--typography-weight-normal);
  --font-weight-bold: var(--typography-weight-normal);
}

/* ============================================
   SEMANTIC LAYER - Dark Theme
   ============================================ */

html[data-theme='dark'] {
  /* Background */
  --color-bg-canvas: var(--gray-950);
  --color-bg-surface: var(--gray-900);
  --color-bg-elevated: var(--gray-800);
  --color-bg-subtle: var(--gray-800);
  --color-bg-muted: var(--gray-700);
  --color-bg-accent: var(--brand-500);
  --color-bg-inverse: var(--gray-50);

  /* Text */
  --color-text-primary: var(--gray-50);
  --color-text-secondary: var(--gray-300);
  --color-text-muted: var(--gray-500);
  --color-text-accent: var(--brand-400);
  --color-text-link: var(--brand-300);
  --color-text-disabled: var(--gray-600);
  --color-text-inverse: var(--gray-900);
  --color-text-on-inverse: var(--gray-white);

  /* Border */
  --color-border-default: var(--gray-700);
  --color-border-muted: var(--gray-800);
  --color-border-accent: var(--brand-500);
  --color-border-focus: var(--brand-400);

  /* Action Primary */
  --color-action-primary: var(--brand-500);
  --color-action-primary-hover: var(--brand-400);
  --color-action-primary-active: var(--brand-300);
  --color-action-primary-disabled: var(--gray-800);
  --color-action-primary-text: var(--gray-900);

  /* Action Secondary */
  --color-action-secondary: var(--gray-800);
  --color-action-secondary-hover: var(--gray-700);
  --color-action-secondary-active: var(--gray-600);
  --color-action-secondary-disabled: var(--gray-900);
  --color-action-secondary-text: var(--gray-50);

  /* Status */
  --color-status-success: var(--brand-success);
  --color-status-success-text: var(--gray-900);
  --color-status-warning: var(--brand-warning);
  --color-status-warning-text: var(--gray-900);
  --color-status-error: var(--brand-error);
  --color-status-error-text: var(--gray-white);
  --color-status-info: var(--brand-info);
  --color-status-info-text: var(--gray-900);

  /* On-colors (Contrast Text) */
  --color-on-primary: var(--gray-900);
  --color-on-secondary: var(--gray-50);
  --color-on-success: var(--gray-900);
  --color-on-warning: var(--gray-900);
  --color-on-error: var(--gray-white);
  --color-on-info: var(--gray-900);
  --color-on-inverse: var(--gray-white);

  /* Spacing (identique au light) */
  --space-xs: var(--spacing-4);
  --space-sm: var(--spacing-scale-8);
  --space-md: var(--spacing-scale-16);
  --space-lg: var(--spacing-scale-24);
  --space-xl: var(--spacing-scale-32);

  /* Radius (identique au light) */
  --radius-xs: var(--radius-scale-none);
  --radius-sm: var(--spacing-2);
  --radius-md: var(--radius-scale-md);
  --radius-lg: var(--spacing-scale-8);
  --radius-xl: var(--spacing-scale-12);

  /* Typography (identique au light) */
  --font-size-xs: var(--spacing-scale-12);
  --font-size-sm: var(--typography-14);
  --font-size-base: var(--spacing-scale-16);
  --font-size-lg: var(--typography-18);
  --font-size-xl: var(--spacing-scale-16);
  --font-weight-light: var(--typography-weight-normal);
  --font-weight-normal: var(--typography-weight-normal);
  --font-weight-medium: var(--typography-weight-normal);
  --font-weight-semibold: var(--typography-weight-normal);
  --font-weight-bold: var(--typography-weight-normal);
}
```

---

## Fonction de G√©n√©ration

Voici le code pour g√©n√©rer cet export :

```javascript
/**
 * G√©n√®re un export CSS conforme aux standards
 * @param {Object} tokens - Tous les tokens (primitives + semantic)
 * @param {string} naming - Type de librairie ('tailwind', 'mui', etc.)
 * @returns {string} Code CSS format√©
 */
function generateCSSExport(tokens, naming) {
    var css = '';
    var now = new Date().toISOString().split('T')[0];

    // Header
    css += '/**\n';
    css += ' * Design Tokens - CSS Variables\n';
    css += ' * Generated by PolyToken\n';
    css += ' * Library: ' + naming + '\n';
    css += ' * Generated: ' + now + '\n';
    css += ' */\n\n';

    // ============================================
    // PRIMITIVES
    // ============================================
    css += '/* ============================================\n';
    css += '   PRIMITIVES - D√©finitions de base\n';
    css += '   ============================================ */\n\n';
    css += ':root {\n';

    // Brand colors
    if (tokens.brand && Object.keys(tokens.brand).length > 0) {
        css += '  /* BRAND */\n';
        for (var key in tokens.brand) {
            if (!tokens.brand.hasOwnProperty(key)) continue;
            css += '  --brand-' + key + ': ' + tokens.brand[key] + ';\n';
        }
        css += '\n';
    }

    // Gray colors
    if (tokens.gray && Object.keys(tokens.gray).length > 0) {
        css += '  /* GRAY */\n';
        for (var key in tokens.gray) {
            if (!tokens.gray.hasOwnProperty(key)) continue;
            css += '  --gray-' + key + ': ' + tokens.gray[key] + ';\n';
        }
        css += '\n';
    }

    // Radius
    if (tokens.radius && Object.keys(tokens.radius).length > 0) {
        css += '  /* RADIUS */\n';
        for (var key in tokens.radius) {
            if (!tokens.radius.hasOwnProperty(key)) continue;
            var value = tokens.radius[key];
            // Ajouter 'px' si c'est un nombre
            if (typeof value === 'number') value = value + 'px';
            css += '  --radius-scale-' + key + ': ' + value + ';\n';
        }
        css += '\n';
    }

    // Spacing
    if (tokens.spacing && Object.keys(tokens.spacing).length > 0) {
        css += '  /* SPACING */\n';
        for (var key in tokens.spacing) {
            if (!tokens.spacing.hasOwnProperty(key)) continue;
            var value = tokens.spacing[key];
            if (typeof value === 'number') value = value + 'px';
            css += '  --spacing-' + key + ': ' + value + ';\n';
        }
        css += '\n';
    }

    // Typography
    if (tokens.typography && Object.keys(tokens.typography).length > 0) {
        css += '  /* TYPOGRAPHY */\n';
        for (var key in tokens.typography) {
            if (!tokens.typography.hasOwnProperty(key)) continue;
            var value = tokens.typography[key];
            // Convertir les tailles en rem si n√©cessaire
            if (typeof value === 'number' && key.includes('size')) {
                value = (value / 16) + 'rem';
            }
            css += '  --typography-' + key + ': ' + value + ';\n';
        }
        css += '\n';
    }

    css += '}\n\n';

    // ============================================
    // SEMANTIC LAYER - LIGHT
    // ============================================
    css += '/* ============================================\n';
    css += '   SEMANTIC LAYER - Light Theme\n';
    css += '   ============================================ */\n\n';
    css += "html[data-theme='light'] {\n";

    if (tokens.semantic) {
        css += generateSemanticCSS(tokens.semantic, 'light', naming);
    }

    css += '}\n\n';

    // ============================================
    // SEMANTIC LAYER - DARK
    // ============================================
    css += '/* ============================================\n';
    css += '   SEMANTIC LAYER - Dark Theme\n';
    css += '   ============================================ */\n\n';
    css += "html[data-theme='dark'] {\n";

    if (tokens.semantic) {
        css += generateSemanticCSS(tokens.semantic, 'dark', naming);
    }

    css += '}\n';

    return css;
}

/**
 * G√©n√®re le CSS pour les tokens s√©mantiques d'un mode
 * @param {Object} semantic - Tokens s√©mantiques
 * @param {string} mode - 'light' ou 'dark'
 * @param {string} naming - Type de librairie
 * @returns {string} CSS format√©
 */
function generateSemanticCSS(semantic, mode, naming) {
    var css = '';
    
    // Grouper les tokens par cat√©gorie
    var groups = {
        'Background': [],
        'Text': [],
        'Border': [],
        'Action Primary': [],
        'Action Secondary': [],
        'Status': [],
        'On-colors': [],
        'Spacing': [],
        'Radius': [],
        'Typography': []
    };

    // Classer les tokens
    for (var key in semantic) {
        if (!semantic.hasOwnProperty(key)) continue;
        
        var token = semantic[key];
        var modeData = token.modes && token.modes[mode];
        if (!modeData) continue;

        var cssName = key.replace(/\./g, '-');
        var aliasRef = modeData.aliasRef;
        var resolvedValue = modeData.resolvedValue;

        // D√©terminer le groupe
        var group = 'Other';
        if (key.startsWith('bg.')) group = 'Background';
        else if (key.startsWith('text.')) group = 'Text';
        else if (key.startsWith('border.')) group = 'Border';
        else if (key.startsWith('action.primary.')) group = 'Action Primary';
        else if (key.startsWith('action.secondary.')) group = 'Action Secondary';
        else if (key.startsWith('status.')) group = 'Status';
        else if (key.startsWith('on.')) group = 'On-colors';
        else if (key.startsWith('space.')) group = 'Spacing';
        else if (key.startsWith('radius.')) group = 'Radius';
        else if (key.startsWith('font.')) group = 'Typography';

        // G√©n√©rer la ligne CSS
        var line = '  --color-' + cssName + ': ';
        
        if (aliasRef && aliasRef.category && aliasRef.key) {
            // Utiliser l'alias
            line += 'var(--' + aliasRef.category + '-' + aliasRef.key + ')';
        } else {
            // Utiliser la valeur brute
            line += resolvedValue;
        }
        
        line += ';\n';

        if (!groups[group]) groups[group] = [];
        groups[group].push(line);
    }

    // G√©n√©rer le CSS par groupe
    for (var groupName in groups) {
        if (!groups.hasOwnProperty(groupName)) continue;
        if (groups[groupName].length === 0) continue;

        css += '  /* ' + groupName + ' */\n';
        groups[groupName].forEach(function(line) {
            css += line;
        });
        css += '\n';
    }

    return css;
}
```

---

## Utilisation

```javascript
// Dans le message handler
case 'export-css':
    var cssContent = generateCSSExport(cachedTokens, naming);
    figma.ui.postMessage({
        type: 'export-ready',
        format: 'css',
        content: cssContent,
        filename: 'design-tokens.css'
    });
    break;
```

---

## Validation

Pour valider que l'export est correct :

### ‚úÖ Checklist Structure
- [ ] `:root` contient uniquement les primitives
- [ ] `html[data-theme='light']` contient les s√©mantiques light
- [ ] `html[data-theme='dark']` contient les s√©mantiques dark
- [ ] Pas de duplication entre `:root` et les th√®mes

### ‚úÖ Checklist Alias
- [ ] Tous les tokens s√©mantiques utilisent `var(--primitive)`
- [ ] Pas de valeurs brutes (#FFFFFF) dans les s√©mantiques
- [ ] Les alias pointent vers des primitives existantes
- [ ] Format des alias : `var(--category-key)`

### ‚úÖ Checklist Compl√©tude
- [ ] Tous les tokens de `SEMANTIC_TOKENS` sont pr√©sents
- [ ] Les deux modes (light/dark) ont le m√™me nombre de tokens
- [ ] Pas de tokens manquants par rapport √† l'exemple

### ‚úÖ Checklist Format
- [ ] Indentation coh√©rente (2 espaces)
- [ ] Commentaires de section pr√©sents
- [ ] Header avec m√©tadonn√©es
- [ ] Pas de lignes vides excessives

---

## Exemple d'Utilisation dans un Projet

```html
<!DOCTYPE html>
<html lang="fr" data-theme="light">
<head>
    <link rel="stylesheet" href="design-tokens.css">
    <style>
        body {
            background-color: var(--color-bg-canvas);
            color: var(--color-text-primary);
            font-size: var(--font-size-base);
        }

        .button-primary {
            background-color: var(--color-action-primary);
            color: var(--color-action-primary-text);
            border-radius: var(--radius-md);
            padding: var(--space-sm) var(--space-md);
        }

        .button-primary:hover {
            background-color: var(--color-action-primary-hover);
        }

        .button-primary:active {
            background-color: var(--color-action-primary-active);
        }

        .button-primary:disabled {
            background-color: var(--color-action-primary-disabled);
        }
    </style>
</head>
<body>
    <button class="button-primary">Click me</button>
    
    <script>
        // Toggle theme
        const toggle = document.querySelector('.theme-toggle');
        toggle.addEventListener('click', () => {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
        });
    </script>
</body>
</html>
```

---

## Avantages de cette Structure

1. **‚úÖ S√©paration claire** : Primitives vs S√©mantiques
2. **‚úÖ Th√®mes faciles** : Changer `data-theme` suffit
3. **‚úÖ Maintenabilit√©** : Modifier une primitive met √† jour tous les alias
4. **‚úÖ Performance** : CSS natif, pas de JS runtime
5. **‚úÖ Compatibilit√©** : Fonctionne dans tous les navigateurs modernes
6. **‚úÖ Type-safe** : Les alias cass√©s sont d√©tect√©s au build
