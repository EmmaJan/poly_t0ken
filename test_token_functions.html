<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Fonctions de Génération de Tokens</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { padding: 10px 20px; margin: 10px; background: #007acc; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #005aa3; }
        .log { border: 1px solid #ddd; padding: 10px; margin: 20px 0; background: #f9f9f9; max-height: 600px; overflow-y: auto; font-family: monospace; font-size: 12px; }
        .error { color: red; }
        .success { color: green; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>Test des Fonctions de Génération de Tokens</h1>

    <button id="runTests">Lancer les tests</button>
    <button id="clearLog">Effacer le log</button>

    <div class="log" id="log"></div>

    <!-- Charger le code du plugin pour les tests -->
    <script src="code.js"></script>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            entry.className = type;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(`[${type}] ${message}`);
        }

        function runTests() {
            log('=== Démarrage des tests des fonctions de génération de tokens ===', 'info');

            // Test des fonctions utilitaires
            log('Test des fonctions utilitaires...', 'info');

            try {
                var hsl = hexToHsl('#FF0000');
                log('✓ hexToHsl("#FF0000"): ' + JSON.stringify(hsl), 'success');
            } catch (error) {
                log('✗ Erreur hexToHsl: ' + error.message, 'error');
            }

            try {
                var hex = hslToHex(0, 100, 50);
                log('✓ hslToHex(0, 100, 50): ' + hex, 'success');
            } catch (error) {
                log('✗ Erreur hslToHex: ' + error.message, 'error');
            }

            // Test des fonctions de génération
            log('Test des fonctions de génération...', 'info');

            const testFunctions = [
                { name: 'generateBrandColors', args: ['#007ACC', 'custom'] },
                { name: 'generateSystemColors', args: ['custom'] },
                { name: 'generateGrayscale', args: ['custom'] },
                { name: 'generateSpacing', args: ['custom'] },
                { name: 'generateRadius', args: ['custom'] },
                { name: 'generateTypography', args: ['custom'] },
                { name: 'generateBorder', args: [] }
            ];

            testFunctions.forEach(test => {
                try {
                    const result = window[test.name](...test.args);
                    const resultStr = typeof result === 'object' ? JSON.stringify(result, null, 2) : result;
                    log(`✓ ${test.name}(${test.args.join(', ')}): ${resultStr.substring(0, 200)}${resultStr.length > 200 ? '...' : ''}`, 'success');
                } catch (error) {
                    log(`✗ Erreur ${test.name}: ${error.message}`, 'error');
                }
            });

            // Test intégré
            log('Test de génération complète...', 'info');
            try {
                const tokens = {
                    brand: generateBrandColors('#007ACC', 'custom'),
                    system: generateSystemColors('custom'),
                    gray: generateGrayscale('custom'),
                    spacing: generateSpacing('custom'),
                    radius: generateRadius('custom'),
                    typography: generateTypography('custom'),
                    border: generateBorder()
                };

                log('✓ Génération complète réussie: ' + Object.keys(tokens).length + ' catégories', 'success');
                log('Tokens générés: ' + Object.keys(tokens).join(', '), 'info');
            } catch (error) {
                log('✗ Erreur génération complète: ' + error.message, 'error');
            }

            log('=== Tests terminés ===', 'info');
        }

        document.getElementById('runTests').addEventListener('click', runTests);
        document.getElementById('clearLog').addEventListener('click', () => {
            document.getElementById('log').innerHTML = '';
        });

        // Auto-run tests after a short delay
        setTimeout(() => {
            log('Auto-démarrage des tests dans 2 secondes...', 'info');
            setTimeout(runTests, 2000);
        }, 500);
    </script>
</body>
</html>